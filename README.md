# politalk_extractor
정치인 발언발췌 프로젝트

정치인 발언 데이터 자동 추출 및 가공 도구

## 개요
정치인 발언 데이터에서 발언자, 목적, 주제, 요약 등 다양한 정보를 자동으로 추출하여 CSV → Excel로 변환하는 Python 기반 도구입니다.  
GUI를 통해 손쉽게 파일을 선택하고, AI/NLP 기반으로 데이터를 정제·가공할 수 있습니다.

---

## 입력 데이터 형식 (CSV)

| 일자       | 이름           | 신문사   | 제목                | 발췌문단 | 발췌문장                |
|------------|----------------|----------|---------------------|----------|-------------------------|
| 2024-06-01 | 홍길동 의원     | 중앙일보 | 경제정책 변화 필요  | 1        | "경제정책을 바꿔야 한다" |
| 2024-06-01 | 김철수 대표     | 한겨레   | 복지 확대 주장      | 2        | "복지를 확대해야 한다"   |

- **필수 컬럼:** 일자, 이름, 신문사, 제목, 발췌문단, 발췌문장

---

## 출력 데이터 형식 (Excel/CSV)

| 날짜       | 발언자 성명 및 직책 | 신문사   | 기사 제목           | 주제         | 문단 | 발언의 목적 배경 취지 | 큰따옴표 발언         |
|------------|--------------------|----------|---------------------|--------------|------|----------------------|-----------------------|
| 2024-06-01 | 홍길동 의원        | 중앙일보 | 경제정책 변화 필요  | 경제정책      | 1    | 경제정책 변화 촉구   | "경제정책을 바꿔야 한다" |
| 2024-06-01 | 김철수 대표        | 한겨레   | 복지 확대 주장      | 복지정책      | 2    | 복지 확대 주장       | "복지를 확대해야 한다"   |

---

## 입출력 파일 예시

### 입력 CSV 예시
```csv
일자,이름,신문사,제목,발췌문단,발췌문장
2024-06-01,홍길동 의원,중앙일보,경제정책 변화 필요,1,"경제정책을 바꿔야 한다"
2024-06-01,김철수 대표,한겨레,복지 확대 주장,2,"복지를 확대해야 한다"
```

### 출력 Excel/CSV 예시
```csv
날짜,발언자 성명 및 직책,신문사,기사 제목,주제,문단,발언의 목적 배경 취지,큰따옴표 발언
2024-06-01,홍길동 의원,중앙일보,경제정책 변화 필요,경제정책,1,경제정책 변화 촉구,"경제정책을 바꿔야 한다"
2024-06-01,김철수 대표,한겨레,복지 확대 주장,복지정책,2,복지 확대 주장,"복지를 확대해야 한다"
```

---

## 주요 기능 및 처리 방식

### 1. CSV 데이터 추출
- 입력 CSV 파일에서 각 행을 읽어 발언자, 기사 제목, 발췌문장 등 주요 정보를 추출합니다.
- 쉼표 등으로 분리된 복수 문장도 개별적으로 처리합니다.

### 2. 데이터 병합 및 정제
- 같은 기사, 같은 발언자, 같은 날짜, 같은 신문사의 연속된 발언은 병합합니다.
- 중복된 발언문(큰따옴표 발언)은 유사도 검사 및 정규화로 제거합니다.

### 3. 발언 목적/배경/취지 추출
- 기사 제목, 발언문, 문단 등 맥락을 바탕으로 NLP 기반 요약 모델을 활용해 목적/배경/취지를 자동 추출합니다.
- 이전 행과의 연결성(순접 접속사 등)도 고려합니다.

### 4. 주제 추출
- 기사 제목, 발언문, 목적/배경/취지 등을 종합해 KoBART 등 사전학습 모델로 주제를 요약/추출합니다.
- 제목과 본문에서 공통된 핵심어, 5W1H 등도 활용합니다.

### 5. GUI 및 파일 저장
- Tkinter 기반 GUI에서 파일 선택, 변환 실행, 진행상황 표시.
- 결과는 Excel(.xlsx) 및 CSV(.csv)로 저장됩니다.

---

## 실행 방법

1. Python 3.x 환경 준비
2. 필수 패키지 설치
   ```
   pip install -r requirements.txt
   ```
3. `main.py` 실행
   ```
   python main.py
   ```
4. 로그인 후 GUI에서 파일 선택 및 변환

---

## 주요 파일 설명
- `main.py` : 프로그램 실행 및 환경설정, 로그인/GUI 실행
- `gui_manager.py` : Tkinter 기반 GUI
- `login.py` : 로그인 창
- `file_manager.py` : 데이터 입출력 및 전처리
- `text_manager.py` : 텍스트 처리 및 NLP 함수
- `extract_purpose.py` : 발언 목적 추출
- `extract_topic.py`, `extract_topic_title_and_summary.py` : 주제/요약 추출
- `modify_title.py` : 제목 등 텍스트 정제
- `test_all_files.py` : 전체 기능 테스트

---

## 데이터 파일
- `ko.bin`, `ko.kv`, `ko_reformatted.vec` : 한국어 임베딩/모델 파일

---

## 라이선스
(필요시 작성)
